mutate(temp_bin = factor(temp_bin, levels = unique(temp_bin),
ordered = T),
smoke_bin = factor(smoke_bin, levels = unique(smoke_bin),
ordered = T)) %>%
ggplot(aes(x = smoke_bin,
y = rel_val,
color = temp_bin,
fill = temp_bin,
group = temp_bin)) +
geom_col() +
geom_hline(yintercept = c(50, 80, 90, 95),
linetype = "dashed", alpha = 0.5) +
scale_color_manual(values = MetBrewer::met.brewer("Hiroshige", 5),
aesthetics = c("color", "fill")) +
theme_classic() + xlab("") + ylab(""),
data.frame(smoke_bin = c("non", "0-5", "5-10", "10-25", "25+"),
any_smoke = c(0, 1, 1, 1, 1),
temp = "temp",
val = c(96, 4*0.77, 4*0.14, 4*0.07, 4*0.03)) %>%
mutate(smoke_bin = factor(smoke_bin, levels = rev(smoke_bin), ordered = T)) %>%
ggplot(aes(y = val, x = temp,
group = smoke_bin,
fill = smoke_bin,
color = smoke_bin)) +
geom_col() +
theme_classic() +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank()) +
xlab("") + ylab("") +
facet_zoom(ylim = c(95.9, 100),
# zoom.data = any_smoke == 1,
zoom.size = 1),
nrow = 2, rel_heights = c(1, 0.6))
plot_grid(test_df %>%
mutate(temp_bin = factor(temp_bin, levels = unique(temp_bin),
ordered = T),
smoke_bin = factor(smoke_bin, levels = unique(smoke_bin),
ordered = T)) %>%
ggplot(aes(x = smoke_bin,
y = rel_val,
color = temp_bin,
fill = temp_bin,
group = temp_bin)) +
geom_col() +
geom_hline(yintercept = c(50, 80, 90, 95),
linetype = "dashed", alpha = 0.5) +
scale_color_manual(values = MetBrewer::met.brewer("Hiroshige", 5),
aesthetics = c("color", "fill")) +
theme_classic() + xlab("") + ylab(""),
data.frame(smoke_bin = c("non", "0-5", "5-10", "10-25", "25+"),
any_smoke = c(0, 1, 1, 1, 1),
temp = "temp",
val = c(96, 4*0.77, 4*0.14, 4*0.07, 4*0.03)) %>%
mutate(smoke_bin = factor(smoke_bin, levels = rev(smoke_bin), ordered = T)) %>%
ggplot(aes(y = val, x = temp,
group = smoke_bin,
fill = smoke_bin,
color = smoke_bin)) +
geom_col() +
theme_classic() +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank()) +
xlab("") + ylab("") +
facet_zoom(ylim = c(95.9, 100),
# zoom.data = any_smoke == 1,
zoom.size = 1),
nrow = 1, rel_heights = c(1, 0.6))
plot_grid(test_df %>%
mutate(temp_bin = factor(temp_bin, levels = unique(temp_bin),
ordered = T),
smoke_bin = factor(smoke_bin, levels = unique(smoke_bin),
ordered = T)) %>%
ggplot(aes(y = smoke_bin,
x = rel_val,
color = temp_bin,
fill = temp_bin,
group = temp_bin)) +
geom_col() +
geom_vline(xintercept = c(50, 80, 90, 95),
linetype = "dashed", alpha = 0.5) +
scale_color_manual(values = MetBrewer::met.brewer("Hiroshige", 5),
aesthetics = c("color", "fill")) +
theme_classic() + xlab("") + ylab(""),
data.frame(smoke_bin = c("non", "0-5", "5-10", "10-25", "25+"),
any_smoke = c(0, 1, 1, 1, 1),
temp = "temp",
val = c(96, 4*0.77, 4*0.14, 4*0.07, 4*0.03)) %>%
mutate(smoke_bin = factor(smoke_bin, levels = rev(smoke_bin), ordered = T)) %>%
ggplot(aes(y = val, x = temp,
group = smoke_bin,
fill = smoke_bin,
color = smoke_bin)) +
geom_col() +
theme_classic() +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank()) +
xlab("") + ylab("") +
facet_zoom(ylim = c(95.9, 100),
# zoom.data = any_smoke == 1,
zoom.size = 1),
nrow = 1, rel_heights = c(1, 0.6))
plot_grid(data.frame(smoke_bin = c("non", "0-5", "5-10", "10-25", "25+"),
any_smoke = c(0, 1, 1, 1, 1),
temp = "temp",
val = c(96, 4*0.77, 4*0.14, 4*0.07, 4*0.03)) %>%
mutate(smoke_bin = factor(smoke_bin, levels = rev(smoke_bin), ordered = T)) %>%
ggplot(aes(y = val, x = temp,
group = smoke_bin,
fill = smoke_bin,
color = smoke_bin)) +
geom_col() +
theme_classic() +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank()) +
xlab("") + ylab("") +
facet_zoom(ylim = c(95.9, 100),
# zoom.data = any_smoke == 1,
zoom.size = 1),
test_df %>%
mutate(temp_bin = factor(temp_bin, levels = unique(temp_bin),
ordered = T),
smoke_bin = factor(smoke_bin, levels = unique(smoke_bin),
ordered = T)) %>%
ggplot(aes(y = smoke_bin,
x = rel_val,
color = temp_bin,
fill = temp_bin,
group = temp_bin)) +
geom_col() +
geom_vline(xintercept = c(50, 80, 90, 95),
linetype = "dashed", alpha = 0.5) +
scale_color_manual(values = MetBrewer::met.brewer("Hiroshige", 5),
aesthetics = c("color", "fill")) +
theme_classic() + xlab("") + ylab(""),
nrow = 1, rel_heights = c(1, 0.6))
plot_grid(data.frame(smoke_bin = c("non", "0-5", "5-10", "10-25", "25+"),
any_smoke = c(0, 1, 1, 1, 1),
temp = "temp",
val = c(96, 4*0.77, 4*0.14, 4*0.07, 4*0.03)) %>%
mutate(smoke_bin = factor(smoke_bin, levels = rev(smoke_bin), ordered = T)) %>%
ggplot(aes(y = val, x = temp,
group = smoke_bin,
fill = smoke_bin,
color = smoke_bin)) +
geom_col() +
theme_classic() +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank()) +
xlab("") + ylab("") +
facet_zoom(ylim = c(95.9, 100),
# zoom.data = any_smoke == 1,
zoom.size = 1),
test_df %>%
mutate(temp_bin = factor(temp_bin, levels = unique(temp_bin),
ordered = T),
smoke_bin = factor(smoke_bin, levels = unique(smoke_bin),
ordered = T)) %>%
ggplot(aes(y = smoke_bin,
x = rel_val,
color = temp_bin,
fill = temp_bin,
group = temp_bin)) +
geom_col() +
geom_vline(xintercept = c(50, 80, 90, 95),
linetype = "dashed", alpha = 0.5) +
scale_color_manual(values = MetBrewer::met.brewer("Hiroshige", 5),
aesthetics = c("color", "fill")) +
theme_classic() + xlab("") + ylab(""),
nrow = 1, rel_widths = c(1, 0.6))
plot_grid(data.frame(smoke_bin = c("non", "0-5", "5-10", "10-25", "25+"),
any_smoke = c(0, 1, 1, 1, 1),
temp = "temp",
val = c(96, 4*0.77, 4*0.14, 4*0.07, 4*0.03)) %>%
mutate(smoke_bin = factor(smoke_bin, levels = rev(smoke_bin), ordered = T)) %>%
ggplot(aes(y = val, x = temp,
group = smoke_bin,
fill = smoke_bin,
color = smoke_bin)) +
geom_col() +
theme_classic() +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank()) +
xlab("") + ylab("") +
facet_zoom(ylim = c(95.9, 100),
# zoom.data = any_smoke == 1,
zoom.size = 1),
test_df %>%
mutate(temp_bin = factor(temp_bin, levels = unique(temp_bin),
ordered = T),
smoke_bin = factor(smoke_bin, levels = unique(smoke_bin),
ordered = T)) %>%
ggplot(aes(y = smoke_bin,
x = rel_val,
color = temp_bin,
fill = temp_bin,
group = temp_bin)) +
geom_col() +
geom_vline(xintercept = c(50, 80, 90, 95),
linetype = "dashed", alpha = 0.5) +
scale_color_manual(values = MetBrewer::met.brewer("Hiroshige", 5),
aesthetics = c("color", "fill")) +
theme_classic() + xlab("") + ylab(""),
nrow = 1, rel_widths = c(0.6, 1))
plot_grid(data.frame(smoke_bin = c("non", "0-5", "5-10", "10-25", "25+"),
any_smoke = c(0, 1, 1, 1, 1),
temp = "temp",
val = c(96, 4*0.77, 4*0.14, 4*0.07, 4*0.03)) %>%
mutate(smoke_bin = factor(smoke_bin, levels = rev(smoke_bin), ordered = T)) %>%
ggplot(aes(y = val, x = temp,
group = smoke_bin,
fill = smoke_bin,
color = smoke_bin)) +
geom_col() +
theme_classic() +
theme(axis.text = element_blank(),
axis.ticks = element_blank(),
axis.line = element_blank(),
legend.position = "left") +
xlab("") + ylab("") +
facet_zoom(ylim = c(95.9, 100),
# zoom.data = any_smoke == 1,
zoom.size = 1),
test_df %>%
mutate(temp_bin = factor(temp_bin, levels = unique(temp_bin),
ordered = T),
smoke_bin = factor(smoke_bin, levels = unique(smoke_bin),
ordered = T)) %>%
ggplot(aes(y = smoke_bin,
x = rel_val,
color = temp_bin,
fill = temp_bin,
group = temp_bin)) +
geom_col() +
geom_vline(xintercept = c(50, 80, 90, 95),
linetype = "dashed", alpha = 0.5) +
scale_color_manual(values = MetBrewer::met.brewer("Hiroshige", 5),
aesthetics = c("color", "fill")) +
theme_classic() + xlab("") + ylab(""),
nrow = 1, rel_widths = c(0.6, 1))
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
NA)) %>%
View
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
NA)) %>%
str
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
T ~ NA)) %>%
str
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
T ~ NA)) %>%
View
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)/100) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
smoke_bin == "0-5" ~ 4*0.77,
smoke_bin == "5-10" ~ 4*0.14,
smoke_bin == "10-25" ~ 4*0.07,
smoke_bin == "25+" ~ 4*0.03,
T ~ NA),
abs_val = rel_val*smoke_total) %>%
View
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)/100) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
smoke_bin == "0-5" ~ 0.04*0.77,
smoke_bin == "5-10" ~ 0.04*0.14,
smoke_bin == "10-25" ~ 0.04*0.07,
smoke_bin == "25+" ~ 0.04*0.03,
T ~ NA),
abs_val = rel_val*smoke_total) %>%
View
?gather_set_data
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)/100) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
smoke_bin == "0-5" ~ 0.04*0.77,
smoke_bin == "5-10" ~ 0.04*0.14,
smoke_bin == "10-25" ~ 0.04*0.07,
smoke_bin == "25+" ~ 0.04*0.03,
T ~ NA),
abs_val = rel_val*smoke_total*100) %>%
select(smoke_bin, temp_bin, abs_val) %>%
gather_set_data(1:2) %>%
str
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)/100) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
smoke_bin == "0-5" ~ 0.04*0.77,
smoke_bin == "5-10" ~ 0.04*0.14,
smoke_bin == "10-25" ~ 0.04*0.07,
smoke_bin == "25+" ~ 0.04*0.03,
T ~ NA),
abs_val = rel_val*smoke_total*100) %>%
select(smoke_bin, temp_bin, abs_val) %>%
gather_set_data(1:2) %>%
{ggplot(data = .,
aes(y = x, id = id, split = y, value = abs_val)) +
geom_parallel_sets(aes(fill = smoke_bin),
alpha = 0.3, axis.width = 0.1) +
geom_parallel_sets_axes(aes(fill = y),
axis.width = 0.1) +
theme_classic()}
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)/100) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
smoke_bin == "0-5" ~ 0.04*0.77,
smoke_bin == "5-10" ~ 0.04*0.14,
smoke_bin == "10-25" ~ 0.04*0.07,
smoke_bin == "25+" ~ 0.04*0.03,
T ~ NA),
abs_val = rel_val*smoke_total*100) %>%
select(smoke_bin, temp_bin, abs_val) %>%
gather_set_data(1:2) %>%
{ggplot(data = .,
aes(y = x, id = id, split = y, value = abs_val)) +
geom_parallel_sets(alpha = 0.3, axis.width = 0.1) +
geom_parallel_sets_axes(aes(fill = y),
axis.width = 0.1) +
theme_classic()}
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)/100) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
smoke_bin == "0-5" ~ 0.04*0.77,
smoke_bin == "5-10" ~ 0.04*0.14,
smoke_bin == "10-25" ~ 0.04*0.07,
smoke_bin == "25+" ~ 0.04*0.03,
T ~ NA),
abs_val = rel_val*smoke_total*100) %>%
select(smoke_bin, temp_bin, abs_val) %>%
gather_set_data(1:2) %>%
{ggplot(data = .,
aes(y = x, id = id, split = y, value = abs_val)) +
geom_parallel_sets(aes(fill = temp_bin),
alpha = 0.3, axis.width = 0.1) +
geom_parallel_sets_axes(aes(fill = y),
axis.width = 0.1) +
theme_classic()}
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)/100) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
smoke_bin == "0-5" ~ 0.04*0.77,
smoke_bin == "5-10" ~ 0.04*0.14,
smoke_bin == "10-25" ~ 0.04*0.07,
smoke_bin == "25+" ~ 0.04*0.03,
T ~ NA),
abs_val = rel_val*smoke_total*100) %>%
select(smoke_bin, temp_bin, abs_val) %>%
gather_set_data(1:2) %>%
{ggplot(data = .,
aes(y = x, id = id, split = y, value = abs_val)) +
geom_parallel_sets(aes(fill = temp_bin),
alpha = 0.3, axis.width = 0.1) +
geom_parallel_sets_axes(aes(fill = y),
axis.width = 0.1) +
geom_parallel_sets_labels(colour = 'black') +
theme_classic()}
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)/100) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
smoke_bin == "0-5" ~ 0.04*0.77,
smoke_bin == "5-10" ~ 0.04*0.14,
smoke_bin == "10-25" ~ 0.04*0.07,
smoke_bin == "25+" ~ 0.04*0.03,
T ~ NA),
abs_val = rel_val*smoke_total*100) %>%
mutate(temp_bin = factor(temp_bin, levels = unique(temp_bin),
ordered = T),
smoke_bin = factor(smoke_bin, levels = unique(smoke_bin),
ordered = T)) %>%
select(smoke_bin, temp_bin, abs_val) %>%
gather_set_data(1:2) %>%
{ggplot(data = .,
aes(y = x, id = id, split = y, value = abs_val)) +
geom_parallel_sets(aes(fill = temp_bin),
alpha = 0.3, axis.width = 0.1) +
geom_parallel_sets_axes(aes(fill = y),
axis.width = 0.1) +
geom_parallel_sets_labels(colour = 'black') +
theme_classic()}
data.frame(smoke_bin = rep(c("non", "0-5", "5-10", "10-25", "25+"),
each = 5),
temp_bin = rep(c("95+", "90-95", "80-90", "50-80","<=50"),
times = 5),
rel_val = c(4, 5, 9, 29, 53,
16, 12, 24, 39, 8,
19, 15, 22, 35, 8,
23, 16, 22, 32, 7,
35, 9, 22, 32, 2)/100) %>%
mutate(smoke_total = case_when(smoke_bin == "non" ~ 0.96,
smoke_bin == "0-5" ~ 0.04*0.77,
smoke_bin == "5-10" ~ 0.04*0.14,
smoke_bin == "10-25" ~ 0.04*0.07,
smoke_bin == "25+" ~ 0.04*0.03,
T ~ NA),
abs_val = rel_val*smoke_total*100) %>%
select(smoke_bin, temp_bin, abs_val) %>%
gather_set_data(1:2) %>%
{ggplot(data = .,
aes(y = x, id = id, split = y, value = abs_val)) +
geom_parallel_sets(aes(fill = temp_bin),
alpha = 0.3, axis.width = 0.1) +
geom_parallel_sets_axes(aes(fill = y),
axis.width = 0.1) +
geom_parallel_sets_labels(colour = 'black') +
theme_classic()}
library(reticulate)
library(rgee)
source("./scripts/00_setup_private.R")
setwd("~/Research/global-dengue-temperature")
ee_Initialize(user = gee_user)
source("./scripts/00_setup_private.R")
ee_Initialize(user = gee_user)
?ee_connect_to_py
??ee_connect_to_py
